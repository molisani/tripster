<html>
<head>
  <!-- jQuery -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <!-- Bootstrap -->
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
  <!-- Handlebars -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js"></script>
</head>

<body>
  <script id="main-content" type="text/x-handlebars-template">
    <div class="panel-body">
      <br>
      <div class="container-fluid">		
        <div class="row">
	  <div class="col-md-12">
            <div class="list-group">
              <div href="#" class="list-group-item active">
                <h4 class="list-group-item-heading">Comments</h4>
              </div>
              {{#each comments}}
              <div class="list-group-item"><i>{{fullname}} says...</i><br>&nbsp;&nbsp;&nbsp;<b>{{comment}}</b></div>
              {{/each}}
              <div class="list-group-item">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Write new comment...">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="button">Submit</button>
                  </span>
                </div>
              </div>
            </div>
          </div>
	  <hr>
          <div class="col-md-3">
            <div class="list-group">
              <div href="#" class="list-group-item active">
                <h4 class="list-group-item-heading">To-Do List</h4>
              </div>
              {{#each todo_list}}
              <a href="#" class="list-group-item">             
                <input type="checkbox"> {{todo_item}}</input>
              </a>
              {{/each}}
            </div>
            <!-- <button type="button" class="btn btn-default">Create New Task</button> -->
            <hr>
            <div class="list-group">
              <div href="#" class="list-group-item active">
                <h4 class="list-group-item-heading">Expenses</h4>
              </div>
              {{#each expenses}}
              <a href="#" class="list-group-item">{{description}} <b>{{cost}}</b> ({{expense_user}})</a>
              {{/each}}
            </div>
            <!-- <button type="button" class="btn btn-default">Add New Expense</button> -->
          </div>
          <div class="col-md-4">
            <div class="list-group">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">Who is Going?</h4>
              </div>
              {{#each users_attending}}
              <a href="./user.html?id={{user_id}}" class="list-group-item">{{fullname}}</a>
              {{/each}}
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
              Bring More People! <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                {{#each all_users}}
                <li><a href="#" id="invite-user" value="{{user_id}}">{{fullname}}</a></li>
                {{/each}}
              </ul>
            </div>
            <hr>
            <div class="list-group">
              <div href="#" class="list-group-item active">
                <h4 class="list-group-item-heading">Where Are We Going?</h4>
              </div>
              {{#each locations}}
              <a href="./trip.html?id={{trip_id}}" class="list-group-item">{{locationname}}, <i>{{country}}</i></a>
              {{/each}}
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
              Go More Places! <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                {{#each location_select}}
                <li><a href="#">{{location_select_locationname}}, <i>{{location_select_country}}</i></a></li>
                {{/each}}
                <li class="divider"></li>
                <li><a href="./create_location.html?trip_id={{trip_id}}">Create New Location</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md-5">
            <div class="list-group">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">Albums from This Trip</h4>
              </div>
            </div>
            {{#each albums}}
            <a href="./album.html?id={{album_id}}" class="thumbnail">
              <img data-src="{{album_thumb_url}}" alt="...">
              <div class="caption">
                <h3>{{albumname}}</h3>
              </div>
            </a>
            {{/each}}
            <button type="button" class="btn btn-default">New Album</button>
          </div>
	  <br>
	</div>
      </div>
    </div>
  </script>
</body>

<script src="js/field_utils.js"></script>
<script src="js/jquery.cookie.min.js"></script>
<script src="tmpl/page.tmpl.js" id="page-template"></script>
<script src="tmpl/sidebar.tmpl.js" id="sidebar-template"></script>
<script type="text/javascript">
$.when(
  $.getScript("./js/templates.js")
  ).done(function(){
    var tripBody = Handlebars.compile($('#main-content').html());
    pageData.page_header = "[[tripname]]";
    pageData.page_body = tripBody({});

    if ($.cookie("username")) {
      pageData.username = $.cookie("username");
      sidebarData.username = $.cookie("username");
    }

    build_page();
    load_sidebar();

    var trip = $_GET('id');
    if (trip != "null") {
      $.ajax({
        url: '../api/trip.py',
        type: 'post',
        data: {
          action: 'info',
          user_id: $.cookie('user_id'),
          token: $.cookie('token'),
          id: trip
        },
        dataType: 'json',
        success: function(json) {
          if (json.status == 'Success') {
            pageData.page_header = "<h1>" + json.trip.tripname + "</h1>";
            pageData.page_body = tripBody(json.trip);
            build_page();
          }
        }
      });
    }
  });
  </script>
  </html>
